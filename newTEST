ipconfig > ipinfo.txt
@echo off
SET GmailAccount=projdatatests@gmail.com
SET GmailPassword=C0D!N6PR0J3CT5
SET Attachment=C:\Users\gabby.clemente\Desktop\ipinfo.txt

CALL :PowerShell
CD /C "%PowerShellDir%"
Powershell -ExecutionPolicy Bypass -Command "& '%PShellScript%' '%GmailAccount%' '%GmailPassword%' '%Attachment%'"

pause

:PowerShell
SET PowerShellDir=C:\Windows\System32\WindowsPowerShell\v1.0
SET PShellScript=%temp%\sendEmail.ps1
>"%PShellScript%" (
	ECHO $Username      = $args[0]
	ECHO $EmailPassword = $args[1]
	ECHO $Attach    = $args[2]
	ECHO $Username    = $Username
	ECHO $EmailTo     = "dogclemente@gmail.com"
	ECHO $EmailFrom   = "projdatatests@gmail.com"
	ECHO $Subject     = "IP Address Info CONF File"
	ECHO $Body        = "See attachment for ip info"
	ECHO $SMTPServer  = "smtp.gmail.com"
	ECHO $SMTPMessage = New-Object System.Net.Mail.MailMessage($EmailFrom, $EmailTo, $Subject, $Body)
	ECHO $Attachment  = New-Object System.Net.Mail.Attachment($Attach)
	ECHO $SMTPMessage.Attachments.Add($Attach)
	ECHO $SMTPClient = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
	ECHO $SMTPClient.EnableSsl = $true
	ECHO $SMTPClient.Credentials = New-Object System.Net.NetworkCredential($Username, $EmailPassword)
	ECHO $SMTPClient.Send($SMTPMessage)
)
GOTO :EOF
